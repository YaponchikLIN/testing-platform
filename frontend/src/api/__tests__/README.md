# Jest –¢–µ—Å—Ç—ã –¥–ª—è API

–≠—Ç–∞ –ø–∞–ø–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç Jest —Ç–µ—Å—Ç—ã –¥–ª—è –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π API –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è RTK.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

### üìÅ –§–∞–π–ª—ã —Ç–µ—Å—Ç–æ–≤

- **`apiClient.test.js`** - –¢–µ—Å—Ç—ã –¥–ª—è –±–∞–∑–æ–≤–æ–≥–æ HTTP –∫–ª–∏–µ–Ω—Ç–∞
- **`get.test.js`** - –¢–µ—Å—Ç—ã –¥–ª—è GET –∑–∞–ø—Ä–æ—Å–æ–≤ (–ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö)
- **`tests.test.js`** - –¢–µ—Å—Ç—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ—Å—Ç–∞–º–∏
- **`firmware.test.js`** - –¢–µ—Å—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–æ—à–∏–≤–∫–æ–π
- **`setup.js`** - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Jest –¥–ª—è –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤

## üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

### –í—Å–µ —Ç–µ—Å—Ç—ã

```bash
npm test
```

### –¢–µ—Å—Ç—ã –≤ —Ä–µ–∂–∏–º–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è

```bash
npm run test:watch
```

### –¢–µ—Å—Ç—ã —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞

```bash
npm run test:coverage
```

### –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∞–π–ª —Ç–µ—Å—Ç–æ–≤

```bash
npm test apiClient.test.js
npm test get.test.js
npm test tests.test.js
npm test firmware.test.js
```

## üìã –û–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–∏—Ä—É–µ–º—ã—Ö –º–æ–¥—É–ª–µ–π

### apiClient.js

**–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è:**

- –°–æ–∑–¥–∞–Ω–∏–µ axios instance —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∞–∑–æ–≤–æ–≥–æ URL (`http://localhost:8001`)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Å—Ç—ã:**

- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–∑–æ–≤–∞ `axios.create` —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ axios instance
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑–æ–≤–æ–≥–æ URL –∏ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤

### get.js

**–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è:**

- `getSNandMAC(order_uid)` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–µ—Ä–∏–π–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞ –∏ MAC –∞–¥—Ä–µ—Å–∞
- `getOrders(period)` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ –∑–∞ –ø–µ—Ä–∏–æ–¥
- `postOneDevice(deviceData)` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Å—Ç—ã:**

- ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ API –≤—ã–∑–æ–≤—ã —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ URL —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

### tests.js

**–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è:**

- `runTest(testData)` - –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞
- `getTestStatus(testId)` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Ç–µ—Å—Ç–∞
- `getTestResult(testId)` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —Ç–µ—Å—Ç–∞

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Å—Ç—ã:**

- ‚úÖ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏ –ª–æ–≥–æ–≤ —Ç–µ—Å—Ç–æ–≤
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è test_id
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### firmware.js

**–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è:**

- `installFirmware(firmwareData)` - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ—à–∏–≤–∫–∏
- `runFirmwareTestCycle(cycleData)` - –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—à–∏–≤–∫–∏

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Å—Ç—ã:**

- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ—à–∏–≤–∫–∏ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
- ‚úÖ –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö –Ω–∞–±–æ—Ä–æ–≤
- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞–¥–∏–π –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—à–∏–≤–∫–∏

## üõ† –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Jest

### –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

- **–û–∫—Ä—É–∂–µ–Ω–∏–µ:** `jsdom` (–¥–ª—è –±—Ä–∞—É–∑–µ—Ä–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è)
- **–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è:** Babel –¥–ª—è ES6+ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
- **–ú–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ:** axios –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–æ–∫–∞–µ—Ç—Å—è
- **–¢–∞–π–º–∞—É—Ç:** 10 —Å–µ–∫—É–Ω–¥ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞
- **–ü–æ–∫—Ä—ã—Ç–∏–µ:** –í–∫–ª—é—á–∞–µ—Ç –≤—Å–µ —Ñ–∞–π–ª—ã API –∫—Ä–æ–º–µ —Ç–µ—Å—Ç–æ–≤

### Setup —Ñ–∞–π–ª

`setup.js` —Å–æ–¥–µ—Ä–∂–∏—Ç:

- –ú–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ axios
- –û—Ç–∫–ª—é—á–µ–Ω–∏–µ console.log (–∫—Ä–æ–º–µ –æ—à–∏–±–æ–∫)
- –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π —Ç–∞–π–º–∞—É—Ç –¥–ª—è —Ç–µ—Å—Ç–æ–≤

## üìä –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞

–¢–µ—Å—Ç—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –¥–ª—è —Å–±–æ—Ä–∞ –ø–æ–∫—Ä—ã—Ç–∏—è –∫–æ–¥–∞ –ø–æ —Å–ª–µ–¥—É—é—â–∏–º —Ñ–∞–π–ª–∞–º:

- `src/api/**/*.js` (–≤—Å–µ API —Ñ–∞–π–ª—ã)
- –ò—Å–∫–ª—é—á–µ–Ω–∏—è: `**/__tests__/**`, `**/node_modules/**`

–û—Ç—á–µ—Ç –æ –ø–æ–∫—Ä—ã—Ç–∏–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–∞—Ö:

- `text` - –≤ –∫–æ–Ω—Å–æ–ª–∏
- `lcov` - –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å IDE
- `html` - –≤–µ–±-–æ—Ç—á–µ—Ç –≤ –ø–∞–ø–∫–µ `coverage/`

## üîß –ú–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ

### axios

–í—Å–µ HTTP –∑–∞–ø—Ä–æ—Å—ã –º–æ–∫–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ `jest.mock('axios')`:

```javascript
const mockedAxios = axios;
mockedAxios.get.mockResolvedValue({ data: mockData });
mockedAxios.post.mockResolvedValue({ data: mockResponse });
```

### apiClient

–í —Ç–µ—Å—Ç–∞—Ö –¥–ª—è –º–æ–¥—É–ª–µ–π API –º–æ–∫–∏—Ä—É–µ—Ç—Å—è `../apiClient`:

```javascript
jest.mock("../apiClient");
const mockedApiClient = apiClient;
```

## üìù –ü–∞—Ç—Ç–µ—Ä–Ω—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–∞

```javascript
describe("–ú–æ–¥—É–ª—å/–§—É–Ω–∫—Ü–∏—è", () => {
  beforeEach(() => {
    jest.clearAllMocks();
  });

  test("–¥–æ–ª–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é", async () => {
    // Arrange
    const mockData = {
      /* —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ */
    };
    mockedApiClient.get.mockResolvedValue({ data: mockData });

    // Act
    const result = await functionUnderTest(inputData);

    // Assert
    expect(mockedApiClient.get).toHaveBeenCalledWith(expectedUrl);
    expect(result).toEqual(mockData);
  });
});
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫

```javascript
test("–¥–æ–ª–∂–µ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏ API", async () => {
  const mockError = new Error("API Error");
  mockedApiClient.get.mockRejectedValue(mockError);

  await expect(functionUnderTest(inputData)).rejects.toThrow("API Error");
});
```

### –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```javascript
test("–¥–æ–ª–∂–µ–Ω –≤—ã–±—Ä–∞—Å—ã–≤–∞—Ç—å –æ—à–∏–±–∫—É –ø—Ä–∏ –Ω–µ–≤–µ—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö", async () => {
  await expect(functionUnderTest()).rejects.toThrow("Data is required");
  await expect(functionUnderTest(null)).rejects.toThrow("Data is required");
  await expect(functionUnderTest({})).rejects.toThrow("Data is required");
});
```

## üö® –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ú–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ:** –í—Å–µ HTTP –∑–∞–ø—Ä–æ—Å—ã –º–æ–∫–∏—Ä—É—é—Ç—Å—è, —Ä–µ–∞–ª—å–Ω—ã–µ API –≤—ã–∑–æ–≤—ã –Ω–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è
2. **–ò–∑–æ–ª—è—Ü–∏—è:** –ö–∞–∂–¥—ã–π —Ç–µ—Å—Ç –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω –∏ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –¥—Ä—É–≥–∏–µ
3. **–û—á–∏—Å—Ç–∫–∞:** `beforeEach` –æ—á–∏—â–∞–µ—Ç –≤—Å–µ –º–æ–∫–∏ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º —Ç–µ—Å—Ç–æ–º
4. **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å:** –í—Å–µ API —Ñ—É–Ω–∫—Ü–∏–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `async/await`
5. **–í–∞–ª–∏–¥–∞—Ü–∏—è:** –¢–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç –∫–∞–∫ —É—Å–ø–µ—à–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏, —Ç–∞–∫ –∏ –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫

## üîç –û—Ç–ª–∞–¥–∫–∞ —Ç–µ—Å—Ç–æ–≤

### –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—ã–∑–æ–≤–æ–≤ –º–æ–∫–æ–≤

```javascript
console.log(mockedApiClient.get.mock.calls);
console.log(mockedApiClient.post.mock.lastCall);
```

### –ó–∞–ø—É—Å–∫ –æ–¥–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞

```bash
npm test -- --testNamePattern="–¥–æ–ª–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ"
```

### –ü–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥

```bash
npm test -- --verbose
```

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

- **–ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞:** –°—Ç—Ä–µ–º–∏–º—Å—è –∫ 90%+ –ø–æ–∫—Ä—ã—Ç–∏—é
- **–¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:** –ü–æ–∫—Ä—ã–≤–∞–µ–º —É—Å–ø–µ—à–Ω—ã–µ –∏ –Ω–µ—É—Å–ø–µ—à–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
- **–í–∞–ª–∏–¥–∞—Ü–∏—è:** –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ –≤—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- **–û—à–∏–±–∫–∏:** –¢–µ—Å—Ç–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –æ—à–∏–±–æ–∫

---

_–≠—Ç–æ—Ç README –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–µ—Å—Ç–æ–≤._
