# Компоненты системы и их взаимодействие

## Основные компоненты

### 1. Уровень интеграции с оборудованием

- **Контроллер Orange Pi**: Управляет коммуникацией с устройством Orange Pi
- **Менеджер сетевых устройств**: Взаимодействует с роутером и коммутатором
- **Интерфейс программатора**: Управляет аппаратным программатором
- **Хранилище конфигураций устройств**: Поддерживает настройки и конфигурации устройств

### 2. Уровень тестового фреймворка

- **Исполнитель тестов**: Выполняет тестовые наборы Robot Framework
- **Тестовая библиотека**: Пользовательские библиотеки Robot Framework для взаимодействия с оборудованием
- **Менеджер тестовых данных**: Обрабатывает подготовку и очистку тестовых данных
- **Сборщик результатов тестов**: Захватывает и обрабатывает результаты выполнения тестов

### 3. Уровень API

- **API-шлюз**: Точка входа для всех API-запросов
- **API управления тестами**: Конечные точки для управления выполнением тестов
- **API результатов**: Конечные точки для получения и анализа результатов тестов
- **API управления устройствами**: Конечные точки для управления аппаратными устройствами
- **Сервис аутентификации**: Обрабатывает аутентификацию и авторизацию пользователей

### 4. Уровень хранения данных

- **База данных результатов тестов**: Хранит подробные результаты выполнения тестов
- **База данных конфигураций**: Хранит конфигурации системы и устройств
- **База данных пользователей**: Хранит информацию о пользователях и разрешениях
- **Журнал аудита**: Записывает все действия в системе для отслеживания

### 5. Уровень фронтенда

- **Панель управления**: Предоставляет обзор состояния системы и результатов тестов
- **Интерфейс управления тестами**: Интерфейс для управления и выполнения тестов
- **Просмотрщик результатов**: Детальное представление результатов тестов с фильтрацией и анализом
- **Интерфейс конфигурации**: Интерфейс для управления конфигурациями системы и устройств

### 6. Интеграционные сервисы

- **Шина событий**: Обеспечивает коммуникацию между компонентами
- **Сервис уведомлений**: Отправляет оповещения и уведомления
- **Планировщик**: Управляет запланированными выполнениями тестов
- **Движок отчетов**: Генерирует отчеты на основе результатов тестов

## Взаимодействие компонентов

### Поток выполнения тестов

1. Пользователь инициирует выполнение теста через UI или API
2. API-шлюз проверяет запрос и перенаправляет в API управления тестами
3. API управления тестами создает задачу выполнения теста
4. Планировщик выбирает задачу и запускает Исполнитель тестов
5. Исполнитель тестов выполняет тесты с использованием Robot Framework
6. Уровень интеграции с оборудованием обеспечивает управление устройствами во время выполнения теста
7. Сборщик результатов тестов захватывает результаты и отправляет их в API результатов
8. API результатов сохраняет результаты в Базе данных результатов тестов
9. Шина событий публикует событие завершения теста
10. Сервис уведомлений отправляет оповещения на основе результатов тестов
11. Панель управления обновляется, чтобы показать последний статус теста

### Поток управления конфигурацией

1. Пользователь обновляет конфигурацию через Интерфейс конфигурации
2. API-шлюз перенаправляет запрос в API управления устройствами
3. API управления устройствами проверяет и сохраняет конфигурацию в Базе данных конфигураций
4. Шина событий публикует событие изменения конфигурации
5. Уровень интеграции с оборудованием применяет новую конфигурацию к устройствам
6. Журнал аудита записывает изменение конфигурации

### Поток мониторинга в реальном времени

1. Аппаратные устройства отправляют обновления статуса на Уровень интеграции с оборудованием
2. Уровень интеграции с оборудованием публикует события статуса устройств в Шину событий
3. Панель управления подписывается на события статуса устройств
4. UI обновляется в реальном времени, чтобы показать текущий статус устройств

## Диаграмма потока данных

```
┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│  Фронтенд   │◄───►│ API-шлюз    │◄───►│ Исполнитель │
│             │     │             │     │ тестов      │
└─────────────┘     └─────────────┘     └─────────────┘
       ▲                   ▲                   ▲
       │                   │                   │
       ▼                   ▼                   ▼
┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│ Шина        │◄───►│ Хранилище   │◄───►│ Интеграция  │
│ событий     │     │ данных      │     │ с оборуд.   │
└─────────────┘     └─────────────┘     └─────────────┘
       ▲                                       ▲
       │                                       │
       ▼                                       ▼
┌─────────────┐                         ┌─────────────┐
│ Сервис      │                         │ Физические  │
│ уведомлений │                         │ устройства  │
└─────────────┘                         └─────────────┘
```
